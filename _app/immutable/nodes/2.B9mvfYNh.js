import{t as _e,a as ae,c as He}from"../chunks/BKAs4E9C.js";import{i as Ue}from"../chunks/oXePn5WF.js";import{z as he,A as ge,C as Be,D as ce,T as Ve,b as Ye,L as le,h as C,G as ze,M as Ke,k as l,X as Ie,Y as Xe,Z as me,K as ie,c as Q,N as Fe,_ as Le,a as Ce,$ as Qe,a0 as se,R as Se,a1 as ye,a2 as K,a3 as Ee,a4 as de,a5 as We,Q as Ze,a6 as je,d as Je,a7 as pe,a8 as ea,I as aa,B as ra,a9 as Oe,aa as ta,ab as na,ac as la,ad as ia,ae as sa,af as oa,g as ua,ag as fa,ah as Me,ai as va,q as ca,aj as _a,ak as da,t as W,v as L,x,s as pa,al as X,w as $,am as be,an as ha,f as ga,ao as Ae}from"../chunks/BjwaUEoV.js";import{d as ma,s as re}from"../chunks/CaNj0KER.js";let ke=!1;function Pe(){ke||(ke=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{var a;if(!e.defaultPrevented)for(const r of e.target.elements)(a=r.__on_r)==null||a.call(r)})},{capture:!0}))}function ya(e){var a=Be,r=ce;he(null),ge(null);try{return e()}finally{he(a),ge(r)}}function Ge(e,a,r,n=r){e.addEventListener(a,()=>ya(r));const t=e.__on_r;t?e.__on_r=()=>{t(),n(!0)}:e.__on_r=()=>n(!0),Pe()}function oe(e,a){return a}function Ea(e,a,r,n){for(var t=[],i=a.length,f=0;f<i;f++)We(a[f].e,t,!0);var h=i>0&&t.length===0&&r!==null;if(h){var d=r.parentNode;Ze(d),d.append(r),n.clear(),q(e,a[0].prev,a[i-1].next)}je(t,()=>{for(var k=0;k<i;k++){var m=a[k];h||(n.delete(m.k),q(e,m.prev,m.next)),Je(m.e,!h)}})}function ue(e,a,r,n,t,i=null){var f=e,h={flags:a,items:new Map,first:null},d=(a&Oe)!==0;if(d){var k=e;f=C?le(ze(k)):k.appendChild(Ve())}C&&Ke();var m=null,M=!1,u=Ie(()=>{var _=r();return ra(_)?_:_==null?[]:Se(_)});Ye(()=>{var _=l(u),s=_.length;if(M&&s===0)return;M=s===0;let w=!1;if(C){var A=f.data===Xe;A!==(s===0)&&(f=me(),le(f),ie(!1),w=!0)}if(C){for(var T=null,R,E=0;E<s;E++){if(Q.nodeType===8&&Q.data===Fe){f=Q,w=!0,ie(!1);break}var o=_[E],v=n(o,E);R=qe(Q,h,T,null,o,v,E,t,a,r),h.items.set(v,R),T=R}s>0&&le(me())}C||ba(_,h,f,t,a,n,r),i!==null&&(s===0?m?Le(m):m=Ce(()=>i(f)):m!==null&&Qe(m,()=>{m=null})),w&&ie(!0),l(u)}),C&&(f=Q)}function ba(e,a,r,n,t,i,f){var F,J,V,c;var h=(t&na)!==0,d=(t&(pe|de))!==0,k=e.length,m=a.items,M=a.first,u=M,_,s=null,w,A=[],T=[],R,E,o,v;if(h)for(v=0;v<k;v+=1)R=e[v],E=i(R,v),o=m.get(E),o!==void 0&&((F=o.a)==null||F.measure(),(w??(w=new Set)).add(o));for(v=0;v<k;v+=1){if(R=e[v],E=i(R,v),o=m.get(E),o===void 0){var te=u?u.e.nodes_start:r;s=qe(te,a,s,s===null?a.first:s.next,R,E,v,n,t,f),m.set(E,s),A=[],T=[],u=s.next;continue}if(d&&Aa(o,R,v,t),(o.e.f&se)!==0&&(Le(o.e),h&&((J=o.a)==null||J.unfix(),(w??(w=new Set)).delete(o))),o!==u){if(_!==void 0&&_.has(o)){if(A.length<T.length){var P=T[0],I;s=P.prev;var U=A[0],B=A[A.length-1];for(I=0;I<A.length;I+=1)Te(A[I],P,r);for(I=0;I<T.length;I+=1)_.delete(T[I]);q(a,U.prev,B.next),q(a,s,U),q(a,B,P),u=P,s=B,v-=1,A=[],T=[]}else _.delete(o),Te(o,u,r),q(a,o.prev,o.next),q(a,o,s===null?a.first:s.next),q(a,s,o),s=o;continue}for(A=[],T=[];u!==null&&u.k!==E;)(u.e.f&se)===0&&(_??(_=new Set)).add(u),T.push(u),u=u.next;if(u===null)continue;o=u}A.push(o),s=o,u=o.next}if(u!==null||_!==void 0){for(var S=_===void 0?[]:Se(_);u!==null;)(u.e.f&se)===0&&S.push(u),u=u.next;var D=S.length;if(D>0){var j=(t&Oe)!==0&&k===0?r:null;if(h){for(v=0;v<D;v+=1)(V=S[v].a)==null||V.measure();for(v=0;v<D;v+=1)(c=S[v].a)==null||c.fix()}Ea(a,S,j,m)}}h&&ta(()=>{var p;if(w!==void 0)for(o of w)(p=o.a)==null||p.apply()}),ce.first=a.first&&a.first.e,ce.last=s&&s.e}function Aa(e,a,r,n){(n&pe)!==0&&ye(e.v,a),(n&de)!==0?ye(e.i,r):e.i=r}function qe(e,a,r,n,t,i,f,h,d,k){var m=(d&pe)!==0,M=(d&ea)===0,u=m?M?K(t):Ee(t):t,_=(d&de)===0?f:Ee(f),s={i:_,v:u,k:i,a:null,e:null,prev:r,next:n};try{return s.e=Ce(()=>h(e,u,_,k),C),s.e.prev=r&&r.e,s.e.next=n&&n.e,r===null?a.first=s:(r.next=s,r.e.next=s.e),n!==null&&(n.prev=s,n.e.prev=s.e),s}finally{}}function Te(e,a,r){for(var n=e.next?e.next.e.nodes_start:r,t=a?a.e.nodes_start:r,i=e.e.nodes_start;i!==n;){var f=aa(i);t.before(i),i=f}}function q(e,a,r){a===null?e.first=r:(a.next=r,a.e.next=r&&r.e),r!==null&&(r.prev=a,r.e.prev=a&&a.e)}function ka(e,a){return e==null?null:String(e)}function Ne(e,a,r,n){var t=e.__style;if(C||t!==a){var i=ka(a);(!C||i!==e.getAttribute("style"))&&(i==null?e.removeAttribute("style"):e.style.cssText=i),e.__style=a}return n}const Ta=Symbol("is custom element"),Na=Symbol("is html");function xe(e){if(C){var a=!1,r=()=>{if(!a){if(a=!0,e.hasAttribute("value")){var n=e.value;$e(e,"value",null),e.value=n}if(e.hasAttribute("checked")){var t=e.checked;$e(e,"checked",null),e.checked=t}}};e.__on_r=r,la(r),Pe()}}function $e(e,a,r,n){var t=xa(e);C&&(t[a]=e.getAttribute(a),a==="src"||a==="srcset"||a==="href"&&e.nodeName==="LINK")||t[a]!==(t[a]=r)&&(a==="loading"&&(e[ia]=r),e.removeAttribute(a))}function xa(e){return e.__attributes??(e.__attributes={[Ta]:e.nodeName.includes("-"),[Na]:e.namespaceURI===sa})}function we(e,a,r=a){var n=oa();Ge(e,"input",t=>{var i=t?e.defaultValue:e.value;if(i=fe(e)?ve(i):i,r(i),n&&i!==(i=a())){var f=e.selectionStart,h=e.selectionEnd;e.value=i??"",h!==null&&(e.selectionStart=f,e.selectionEnd=Math.min(h,e.value.length))}}),(C&&e.defaultValue!==e.value||ua(a)==null&&e.value)&&r(fe(e)?ve(e.value):e.value),fa(()=>{var t=a();fe(e)&&t===ve(e.value)||e.type==="date"&&!t&&!e.value||t!==e.value&&(e.value=t??"")})}function fe(e){var a=e.type;return a==="number"||a==="range"}function ve(e){return e===""?null:+e}function De(e,a,r){if(e.multiple)return wa(e,a);for(var n of e.options){var t=Z(n);if(va(t,a)){n.selected=!0;return}}(!r||a!==void 0)&&(e.selectedIndex=-1)}function $a(e,a){Me(()=>{var r=new MutationObserver(()=>{var n=e.__value;De(e,n)});return r.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{r.disconnect()}})}function Re(e,a,r=a){var n=!0;Ge(e,"change",t=>{var i=t?"[selected]":":checked",f;if(e.multiple)f=[].map.call(e.querySelectorAll(i),Z);else{var h=e.querySelector(i)??e.querySelector("option:not([disabled])");f=h&&Z(h)}r(f)}),Me(()=>{var t=a();if(De(e,t,n),n&&t===void 0){var i=e.querySelector(":checked");i!==null&&(t=Z(i),r(t))}e.__value=t,n=!1}),$a(e)}function wa(e,a){for(var r of e.options)r.selected=~a.indexOf(Z(r))}function Z(e){return"__value"in e?e.__value:e.value}function Ra(e,a,r,n){X(a,Array.from({length:l(r)},()=>Array(l(n)).fill("NONE")))}var Ia=_e("<option> </option>"),La=_e('<div class="tile svelte-h8of0d"> </div>'),Ca=_e('<main class="svelte-h8of0d"><h1>Welcome to drk editor</h1> <p><b>How to:</b> <br>Select a player and a tile <br>Click anywhere on the board to place a tile <br>Right click a tile to delete it</p> <div class="input-container svelte-h8of0d"><div class="input-group svelte-h8of0d"><label for="width">Map width</label> <input type="range" name="width" id="width" min="20" max="60" step="1"> <span> </span></div> <div class="input-group svelte-h8of0d"><label for="height">Map height</label> <input type="range" name="height" id="height" min="20" max="40" step="1"> <span> </span></div> <div class="input-group svelte-h8of0d"><label for="playern">Player</label> <select name="playern" id="playern"><option>Player 1</option><option>Player 2</option></select></div> <div class="input-group svelte-h8of0d"><label for="pickedTile">Tile picker</label> <select name="pickedTile" id="pickedTile"></select></div> <div class="input-group svelte-h8of0d"><input type="button" value="Export"> <input type="button" value="Clear"></div></div> <div class="board svelte-h8of0d"></div> <footer>Noah Mazy</footer></main>');function Ga(e,a){ca(a,!1);let r=K(20),n=K(20),t=K("NONE"),i=K(1);const f=["ALTAR","APPRENTICE","EGG","NONE"],h={ALTAR:"%",APPRENTICE:"@",EGG:"O",NONE:""};let d=K(Array.from({length:l(n)},()=>Array(l(r)).fill("NONE")));function k(c,p){if(l(t)=="EGG"){const g=["name","hatch_time","health","strength","attack_range","regen"],y={position:{x:c+1,y:p+1}};for(const N of g){let O=window.prompt(`Enter the value for ${N}`);if(O===null)return!1;y[N]=O}return console.log("egg:",y),y}else if(l(t)=="APPRENTICE"){const g=["name","health","regen"],y={position:{x:c+1,y:p+1},player:l(i)};for(const N of g){let O=window.prompt(`Enter the value for ${N}`);if(O===null)return!1;y[N]=O}return console.log("apprentice:",y),y}else if(l(t)=="ALTAR")return{position:{x:c+1,y:p+1},player:l(i)};return null}function m(c,p){let g=k(c,p);g!=null&&Ae(d,l(d)[p][c]={tiletype:l(t),pl:l(i),data:g})}function M(c,p){return{ALTAR_1:"background-color: red;",ALTAR_2:"background-color: blue;",APPRENTICE_1:"background-color: yellow;",APPRENTICE_2:"background-color: purple;",EGG_1:"background-color: green;",EGG_2:"background-color: green;"}[c+"_"+p]}function u(){const c=`${l(d).length} ${l(d)[0].length}`,p=[],g=[],y=[];l(d).forEach(G=>{G.forEach(ee=>{if(typeof ee=="object"){const{tiletype:H,data:b}=ee;if(H==="ALTAR")p.push(`${b.player} ${b.position.y} ${b.position.x}`);else if(H==="APPRENTICE"){const ne=b.name.replace(/\s+/g,"_");g.push(`${b.player} ${ne} ${b.position.y} ${b.position.x} ${b.health} ${b.regen}`)}else if(H==="EGG"){const ne=b.name.replace(/\s+/g,"_");y.push(`${ne} ${b.position.y} ${b.position.x} ${b.hatch_time} ${b.health} ${b.strength} ${b.attack_range} ${b.regen}`)}}})});let N=`map:
${c}
altars:
${p.join(`
`)}
apprentices:
${g.join(`
`)}
eggs:
${y.join(`
`)}`;const O=new Blob([N],{type:"text/plain"}),Y=URL.createObjectURL(O),z=document.createElement("a");z.href=Y,z.download="map.drk",z.click(),URL.revokeObjectURL(Y)}_a(()=>(l(d),l(n),l(r)),()=>{X(d,Array.from({length:l(n)},(c,p)=>Array.from({length:l(r)},(g,y)=>{var N;return((N=l(d)[p])==null?void 0:N[y])||"NONE"})))}),da(),Ue();var _=Ca(),s=x(L(_),4),w=L(s),A=x(L(w),2);xe(A);var T=x(A,2),R=L(T,!0);$(T),$(w);var E=x(w,2),o=x(L(E),2);xe(o);var v=x(o,2),te=L(v,!0);$(v),$(E);var P=x(E,2),I=x(L(P),2);W(()=>{l(i),be(()=>{})});var U=L(I);U.value=(U.__value=1)==null?"":1;var B=x(U);B.value=(B.__value=2)==null?"":2,$(I),$(P);var S=x(P,2),D=x(L(S),2);W(()=>{l(t),be(()=>{})}),ue(D,5,()=>f,oe,(c,p)=>{var g=Ia(),y={},N=L(g,!0);$(g),W(()=>{y!==(y=l(p))&&(g.value=(g.__value=l(p))==null?"":l(p)),re(N,l(p))}),ae(c,g)}),$(D),$(S);var j=x(S,2),F=L(j);F.__click=u;var J=x(F,2);J.__click=[Ra,d,n,r],$(j),$(s);var V=x(s,2);ue(V,5,()=>l(d),oe,(c,p,g)=>{var y=He(),N=ga(y);ue(N,1,()=>l(p),oe,(O,Y,z)=>{var G=La();G.__contextmenu=H=>{H.preventDefault(),Ae(d,l(d)[g][z]={tiletype:"NONE",pl:l(i)})},G.__click=()=>m(z,g);var ee=L(G,!0);$(G),W(H=>{Ne(G,H),re(ee,h[l(Y).tiletype])},[()=>M(l(Y).tiletype,l(Y).pl)],Ie),ae(O,G)}),ae(c,y)}),$(V),ha(2),$(_),W(()=>{re(R,l(r)),re(te,l(n)),Ne(V,`grid-template-columns: repeat(${l(r)??""}, 1fr); grid-template-rows: repeat(${l(n)??""}, 1fr);`)}),we(A,()=>l(r),c=>X(r,c)),we(o,()=>l(n),c=>X(n,c)),Re(I,()=>l(i),c=>X(i,c)),Re(D,()=>l(t),c=>X(t,c)),ae(e,_),pa()}ma(["click","contextmenu"]);export{Ga as component};
